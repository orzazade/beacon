---
phase: 11-teams-integration
plan: 03
type: execute
wave: 3
depends_on: ["11-02"]
files_modified: [Views/Components/FilterChips.swift]
autonomous: false
---

<objective>
Add Teams filter chip to UI and verify end-to-end functionality.

Purpose: Complete the Teams integration with UI filter and verify everything works.
Output: Teams filter chip visible, Teams messages appear in task list when signed in.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-teams-integration/11-01-SUMMARY.md
@.planning/phases/11-teams-integration/11-02-SUMMARY.md

# Reference existing patterns:
@Beacon/Views/Components/FilterChips.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Teams filter chip</name>
  <files>Views/Components/FilterChips.swift</files>
  <action>
Add a Teams filter chip to FilterChips.swift alongside existing Azure DevOps, Outlook, and Gmail chips:

1. Find where source filter chips are defined (likely an array or HStack of chips)
2. Add Teams chip with:
   - Label: "Teams"
   - Icon: "bubble.left.fill" (SF Symbol for chat/message)
   - Filter value: TaskSource.teams

Follow the exact pattern used for the other source chips. Teams should appear after Outlook (since both are Microsoft services).
  </action>
  <verify>swift build succeeds, Teams chip added to filter UI</verify>
  <done>Teams filter chip added to FilterChips view</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Microsoft Teams integration with OAuth, models, service, and UI filter</what-built>
  <how-to-verify>
    1. Run the app (Cmd+R in Xcode or `swift run`)
    2. Sign in with Microsoft account
       - NOTE: You'll need to re-consent due to new Chat.Read scope
       - If prompt doesn't appear, sign out and sign back in
    3. Wait for tasks to load
    4. Check filter chips: Teams chip should appear with bubble icon
    5. If you have Teams chats:
       - Recent/urgent messages should appear in task list
       - Teams items show sender name and message preview
    6. Click Teams filter chip: Should filter to only Teams messages
    7. Verify no errors in console output
  </how-to-verify>
  <resume-signal>Type "approved" if Teams integration works, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] swift build succeeds without errors
- [ ] Teams filter chip visible in UI
- [ ] Human verification passed
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Human approved the Teams integration
- Phase 11 complete
</success_criteria>

<output>
After completion, create `.planning/phases/11-teams-integration/11-03-SUMMARY.md`
</output>
